(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin"],{3530:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-container",{attrs:{id:"admin"}},[r("b-row",[r("b-col",{staticClass:"mt-5 d-flex justify-content-end",attrs:{cols:"12"}},[r("b-btn",{staticClass:"ml-2",attrs:{variant:"outline-primary",to:"/admin/products"}},[e._v("商品管理")]),r("b-btn",{staticClass:"ml-2",attrs:{variant:"outline-primary",to:"/admin/orders"}},[e._v("訂單管理")]),r("b-btn",{staticClass:"ml-2",attrs:{variant:"outline-primary",to:"/admin/shops"}},[e._v("店家管理")])],1),r("hr"),r("b-col",{attrs:{cols:"12"}},[r("router-view")],1)],1)],1)},s=[],n=r("2877"),i={},o=Object(n["a"])(i,a,s,!1,null,null,null);t["default"]=o.exports},"81d3":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-3",attrs:{id:"adminshops"}},[r("h1",{staticClass:"text-center"},[e._v("店家管理")]),r("b-btn",{staticClass:"m-6 float-right",attrs:{variant:"outline-success"},on:{click:function(t){return e.$bvModal.show("modal-shop")}}},[e._v("新增")]),r("br",{staticClass:"mb-2"}),r("br",{staticClass:"mb-2"}),r("br",{staticClass:"mb-2"}),r("b-table",{ref:"shopTable",attrs:{items:e.shops,fields:e.fields},scopedSlots:e._u([{key:"cell(image)",fn:function(t){return[t.item?r("img",{staticStyle:{height:"50px"},attrs:{src:t.item.image}}):e._e()]}},{key:"cell(sell)",fn:function(t){return[e._v(e._s(t.item.sell?"v":"X"))]}},{key:"cell(action)",fn:function(t){return[r("b-btn",{attrs:{variant:"outline-success"},on:{click:function(r){return e.editshop(t.index)}}},[e._v("編輯")]),r("b-btn",{attrs:{variant:"outline-danger"},on:{click:function(r){return e.delshop(t.index)}}},[e._v("刪除")])]}}])}),r("b-modal",{attrs:{id:"modal-shop",title:e.form._id.length>0?"編輯店家":"新增店家","ok-variant":"success","ok-title":"送出","cancel-variant":"danger","cancel-title":"取消","ok-disabled":e.submitDisable,"cancel-disabled":e.submitDisable},on:{ok:e.submitModal,hidden:e.resetForm}},[r("b-form-group",{attrs:{label:"品名","label-for":"input-name",state:e.state.name,description:"店名長度限制為 1 個字以上","invalid-feedback":"店名格式不正確"}},[r("b-form-input",{attrs:{id:"input-name",type:"text",required:"",placeholder:"請輸入店名",state:e.state.name},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("b-form-group",{attrs:{label:"地址","label-for":"input-address",state:e.state.address,description:"價格限制為 1 以上","invalid-feedback":"地址格式不正確"}},[r("b-form-input",{attrs:{id:"input-address",type:"text",required:"",placeholder:"請輸入地址",state:e.state.address},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),r("b-form-group",{attrs:{label:"說明","label-for":"input-description"}},[r("b-form-textarea",{attrs:{id:"input-description",type:"text",placeholder:"請輸入說明文字"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("b-form-group",{attrs:{"label-for":"input-phone",state:e.state.phone,"invalid-feedback":"電話格式不正確"}},[r("b-form-input",{attrs:{id:"input-phone",type:"text",required:"",placeholder:"電話號碼",state:e.state.phone},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),r("b-form-group",{attrs:{"label-for":"input-time",state:e.state.time,"invalid-feedback":"營業時間格式不正確"}},[r("b-form-input",{attrs:{id:"input-time",type:"text",required:"",placeholder:"營業時間",state:e.state.time},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}})],1),r("b-form-group",{attrs:{label:"上架","label-for":"input-sell"}},[r("b-form-radio",{attrs:{value:!0},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}},[e._v("上架")]),r("b-form-radio",{attrs:{value:!1},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}},[e._v("下架")])],1),r("img-inputer",{attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改"},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1)],1)},s=[],n=r("1da1"),i=(r("96cf"),r("b0c0"),r("99af"),r("d81d"),{data:function(){return{shops:[],fields:[{key:"image",label:"圖片"},{key:"name",label:"店名"},{key:"phone",label:"電話"},{key:"time",label:"營業時間"},{key:"address",label:"地址"},{key:"sell",label:"上架"},{key:"action",label:"操作"}],submitDisable:!1,form:{name:"",phone:"",address:"",time:"",sell:!1,image:null,_id:""}}},computed:{state:function(){return{name:0!==this.form.name.length||null,phone:0!==this.form.phone||null,address:0!==this.form.address.length||null}}},methods:{editshop:function(e){this.form={name:this.shops[e].name,time:this.shops[e].time,phone:this.shops[e].phone,address:this.shops[e].address,sell:this.shops[e].sell,image:this.shops[e].image,_id:this.shops[e]._id,index:e},this.$bvModal.show("modal-shop")},resetForm:function(e){this.submitDisable?e.preventDefault():this.form={name:"",phone:"",address:"",time:"",sell:!1,image:null,_id:""}},submitModal:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a in e.submitDisable=!0,t.prev=1,r=new FormData,e.form)r.append(a,e.form[a]);if(0!==e.form._id.length){t.next=9;break}return t.next=7,e.axios.post("/shops",r,{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 7:t.next=15;break;case 9:return t.next=11,e.axios.patch("/shops/"+e.form._id,r,{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 11:s=t.sent,n=s.data,e.shops[e.form.index]={name:e.form.name,phone:e.form.phone,address:e.form.address,time:e.form.time,sell:e.form.sell,image:"".concat("https://pett-back.herokuapp.com","/files/").concat(n.result.image),_id:e.form._id},e.$refs.shopTable.refresh();case 15:e.$bvModal.hide("modal-shop"),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](1),e.$swal({icon:"error",title:"錯誤",text:t.t0.response.data.message});case 21:e.submitDisable=!1;case 22:case"end":return t.stop()}}),t,null,[[1,18]])})))()}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/shops/all",{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:r=t.sent,a=r.data,e.shops=a.result.map((function(e){return e.image&&(e.image="".concat("https://pett-back.herokuapp.com","/files/").concat(e.image)),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),o=i,l=r("2877"),c=Object(l["a"])(o,a,s,!1,null,null,null);t["default"]=c.exports},aa93:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mt-3",attrs:{id:"adminproducts"}},[r("h1",{staticClass:"text-center"},[e._v("商品管理")]),r("b-btn",{staticClass:"ml-6 float-right",attrs:{variant:"outline-success"},on:{click:function(t){return e.$bvModal.show("modal-product")}}},[e._v("新增")]),r("br",{staticClass:"mb-2"}),r("br",{staticClass:"mb-2"}),r("br",{staticClass:"mb-2"}),r("b-table",{ref:"productTable",attrs:{items:e.products,fields:e.fields},scopedSlots:e._u([{key:"cell(image)",fn:function(t){return[t.item?r("img",{staticStyle:{height:"50px"},attrs:{src:t.item.image}}):e._e()]}},{key:"cell(sell)",fn:function(t){return[e._v(e._s(t.item.sell?"v":"X"))]}},{key:"cell(action)",fn:function(t){return[r("b-btn",{attrs:{variant:"outline-success"},on:{click:function(r){return e.editProduct(t.index)}}},[e._v("編輯")]),r("b-btn",{attrs:{variant:"outline-danger"},on:{click:function(t){return e.$bvModal.del("modal-product")}}},[e._v("刪除")])]}}])}),r("b-modal",{attrs:{id:"modal-product",title:e.form._id.length>0?"編輯商品":"新增商品","ok-variant":"success","ok-title":"送出","cancel-variant":"danger","cancel-title":"取消","ok-disabled":e.submitDisable,"cancel-disabled":e.submitDisable},on:{ok:e.submitModal,hidden:e.resetForm}},[r("b-form-group",{attrs:{label:"品名","label-for":"input-name",state:e.state.name,description:"品名長度限制為 1 個字以上","invalid-feedback":"品名格式不正確"}},[r("b-form-input",{attrs:{id:"input-name",type:"text",required:"",placeholder:"請輸入品名",state:e.state.name},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("b-form-group",{attrs:{label:"價格","label-for":"input-price",state:e.state.price,description:"價格限制為 0 以上","invalid-feedback":"價格格式不正確"}},[r("b-form-input",{attrs:{id:"input-price",type:"number",required:"",placeholder:"請輸入價格",state:e.state.price},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",e._n(t))},expression:"form.price"}})],1),r("b-form-group",{attrs:{label:"說明","label-for":"input-description"}},[r("b-form-textarea",{attrs:{id:"input-description",type:"text",placeholder:"請輸入說明文字"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("b-form-group",{attrs:{label:"上架","label-for":"input-sell"}},[r("b-form-radio",{attrs:{value:!0},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}},[e._v("上架")]),r("b-form-radio",{attrs:{value:!1},model:{value:e.form.sell,callback:function(t){e.$set(e.form,"sell",t)},expression:"form.sell"}},[e._v("下架")])],1),r("img-inputer",{attrs:{theme:"dark",size:"large",placeholder:"點擊或拖曳選擇圖片","bottom-text":"點擊或拖曳以修改"},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1)],1)},s=[],n=r("1da1"),i=(r("96cf"),r("b0c0"),r("a4d3"),r("e01a"),r("99af"),r("d81d"),{data:function(){return{products:[],fields:[{key:"image",label:"圖片"},{key:"name",label:"品名"},{key:"price",label:"價格"},{key:"description",label:"說明"},{key:"sell",label:"上架"},{key:"action",label:"操作"}],submitDisable:!1,form:{name:"",price:0,description:"",sell:!1,image:null,_id:""}}},computed:{state:function(){return{name:0!==this.form.name.length||null,price:0===this.form.price?null:this.form.price>0}}},methods:{editProduct:function(e){this.form={name:this.products[e].name,price:this.products[e].price,description:this.products[e].description,sell:this.products[e].sell,image:this.products[e].image,_id:this.products[e]._id,index:e},this.$bvModal.show("modal-product")},resetForm:function(e){this.submitDisable?e.preventDefault():this.form={name:"",price:0,description:"",sell:!1,image:null,_id:""}},submitModal:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a in e.submitDisable=!0,t.prev=1,r=new FormData,e.form)r.append(a,e.form[a]);if(0!==e.form._id.length){t.next=9;break}return t.next=7,e.axios.post("/products",r,{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 7:t.next=15;break;case 9:return t.next=11,e.axios.patch("/products/"+e.form._id,r,{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 11:s=t.sent,n=s.data,e.products[e.form.index]={name:e.form.name,price:e.form.price,description:e.form.description,sell:e.form.sell,image:"".concat("https://pett-back.herokuapp.com","/files/").concat(n.result.image),_id:e.form._id},e.$refs.productTable.refresh();case 15:e.$bvModal.hide("modal-product"),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](1),e.$swal({icon:"error",title:"錯誤",text:t.t0.response.data.message});case 21:e.submitDisable=!1;case 22:case"end":return t.stop()}}),t,null,[[1,18]])})))()}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/products/all",{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:r=t.sent,a=r.data,e.products=a.result.map((function(e){return e.image&&(e.image="".concat("https://pett-back.herokuapp.com","/files/").concat(e.image)),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得商品失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),o=i,l=r("2877"),c=Object(l["a"])(o,a,s,!1,null,null,null);t["default"]=c.exports},c732:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},s=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"adminhome"}},[r("h1",{staticClass:"text-center"},[e._v("請選擇管理項目")])])}],n=r("2877"),i={},o=Object(n["a"])(i,a,s,!1,null,null,null);t["default"]=o.exports},e01a:function(e,t,r){"use strict";var a=r("23e7"),s=r("83ab"),n=r("da84"),i=r("5135"),o=r("861d"),l=r("9bf2").f,c=r("e893"),u=n.Symbol;if(s&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var m={},d=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof d?new u(e):void 0===e?u():u(e);return""===e&&(m[t]=!0),t};c(d,u);var p=d.prototype=u.prototype;p.constructor=d;var f=p.toString,b="Symbol(test)"==String(u("test")),h=/^Symbol\((.*)\)[^)]+$/;l(p,"description",{configurable:!0,get:function(){var e=o(this)?this.valueOf():this,t=f.call(e);if(i(m,e))return"";var r=b?t.slice(7,-1):t.replace(h,"$1");return""===r?void 0:r}}),a({global:!0,forced:!0},{Symbol:d})}},ec5c:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"adminorders"}},[r("h1",{staticClass:"text-center"},[e._v("訂單管理")]),r("b-table",{attrs:{items:e.orders,fields:e.fields},scopedSlots:e._u([{key:"cell(name)",fn:function(t){return[e._v(e._s(t.item.user.name))]}},{key:"cell(products)",fn:function(t){return[r("ul",e._l(t.item.products,(function(t){return r("li",[e._v(e._s(t.product.name)+" * "+e._s(t.amount))])})),0)]}}])})],1)},s=[],n=r("1da1"),i=(r("96cf"),r("d81d"),{name:"AdminOrders",data:function(){return{orders:[],fields:[{key:"name",label:"使用者"},{key:"_id",label:"訂單編號"},{key:"date",label:"日期"},{key:"products",label:"商品"}]}},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.axios.get("/users/orders/all",{headers:{authorization:"Bearer "+e.$store.state.jwt.token}});case 3:r=t.sent,a=r.data,e.orders=a.result.map((function(e){return e.date=new Date(e.date).toLocaleString(),e})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.$swal({icon:"error",title:"錯誤",text:"取得訂單失敗"});case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}}),o=i,l=r("2877"),c=Object(l["a"])(o,a,s,!1,null,null,null);t["default"]=c.exports}}]);
//# sourceMappingURL=admin.a9664fe7.js.map